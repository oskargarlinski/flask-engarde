{% extends 'base.html' %}
{% block title %}
  Manage Products
{% endblock %}

{% block content %}
  <div class="container py-5">
    <h1 class="mb-4">Manage Products</h1>

    <div class="mb-4">
      <a href="{{ url_for('admin.new_product') }}" class="btn btn-outline-dark">+ Add New Product</a>
    </div>

    {% if products %}
      <table class="table table-bordered table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Image</th>
            <th>Variants</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for product in products %}
            <tr>
              <td>{{ product.name }}</td>
              <td>{{ product.description[:100] }}...</td>
              <td>
                {% if product.image_filename %}
                  <img src="{{ url_for('static', filename='images/products/' ~ product.image_filename) }}" alt="Product Image" height="60" />
                {% else %}
                  <em>No image</em>
                {% endif %}
              </td>
              <td>
                <a href="{{ url_for('admin.add_variant_options', product_id=product.id) }}" class="btn btn-sm btn-outline-secondary mb-1">+ Options</a>
                <a href="{{ url_for('admin.add_variant_values', product_id=product.id) }}" class="btn btn-sm btn-outline-secondary">+ Values</a>
              </td>
              <td>
                <a href="{{ url_for('admin.add_product_variants', product_id=product.id) }}" class="btn btn-sm btn-outline-primary">Variants</a>
                <a href="{{ url_for('admin.delete_product', product_id=product.id) }}" class="btn btn-sm btn-danger" onclick="return confirm('Delete this product and all its variants?');">Delete</a>
              </td>              
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No products found.</p>
    {% endif %}
  </div>
{% endblock %}
