{% extends 'base.html' %}
{% block title %}
  Manage Products
{% endblock %}

{% block content %}
  <div class="container py-5">
    <h1 class="mb-4">Manage Products</h1>

    <div class="mb-4">
      <a href="{{ url_for('admin.add_product', product_type='weapon') }}" class="btn btn-outline-dark me-2">+ Add Weapon</a>
      <a href="{{ url_for('admin.add_product', product_type='apparel') }}" class="btn btn-outline-dark me-2">+ Add Apparel</a>
      <a href="{{ url_for('admin.add_product', product_type='glove') }}" class="btn btn-outline-dark me-2">+ Add Glove</a>
      <a href="{{ url_for('admin.add_product', product_type='footwear') }}" class="btn btn-outline-dark">+ Add Footwear</a>
    </div>

    {% for product_type, items in products.items() %}
      {% if items %}
        <h3 class="mt-5">{{ product_type.title() }}s</h3>
        <table class="table table-bordered table-hover align-middle">
          <thead class="table-dark">
            <tr>
              <th>Name</th>
              <th>Price</th>

              {% if product_type == 'weapon' %}
                <th>Blade Type</th>
                <th>Certification</th>
              {% elif product_type == 'apparel' %}
                <th>Material</th>
                <th>Certification</th>
                <th>Newton Rating</th>
              {% elif product_type == 'glove' %}
                <th>Certification</th>
              {% endif %}

              <th>Environmental Impact</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for item in items %}
              <tr>
                <td>{{ item.name }}</td>
                <td>£{{ '%.2f'|format(item.price) }}</td>

                {% if product_type == 'weapon' %}
                  <td>{{ item.blade_type }}</td>
                  <td>{{ item.certification }}</td>
                {% elif product_type == 'apparel' %}
                  <td>{{ item.material }}</td>
                  <td>{{ item.certification }}</td>
                  <td>{{ item.newton_rating }}</td>
                {% elif product_type == 'glove' %}
                  <td>{{ item.certification }}</td>
                {% endif %}

                <td>{{ item.environmental_impact }} kg CO₂</td>
                <td>
                  <a href="{{ url_for('admin.edit_product', product_type=product_type, id=item.id) }}" class="btn btn-sm btn-warning">Edit</a>
                  <a href="{{ url_for('admin.delete_product', product_type=product_type, id=item.id) }}" class="btn btn-sm btn-danger" onclick="return confirm('Delete this item?');">Delete</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endif %}
    {% endfor %}
  </div>
{% endblock %}
